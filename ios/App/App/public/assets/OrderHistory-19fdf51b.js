import{d as D,ad as W,ar as B,L as $,N as X,q as F,ax as Y,az as Z,I as L,ac as x,r as M,ap as ee,n as te,s as P,aA as oe,aB as ne,aC as se,aD as ae,aE as re,aF as ie,aG as N,aH as le,_ as T,x as n,o as u,c as m,w as o,A as de,X as ce,Y as ue,e as t,g as a,aI as pe,aJ as _e,aK as me,aL as he,aM as fe,i as Ie,k as ge,p as Oe,aN as ve,aO as Se,F as be,j as we,G as ke,m as ye,C as Ce,t as v,aP as k,aQ as y,f as C,B as De}from"./index-f92ce253.js";import{N as Be}from"./NotificationButton-bfbf6cba.js";import{u as H}from"./OrderStore-6d589189.js";import{f as A}from"./Filters-875bda85.js";import{I as $e}from"./Image-ab8c6f04.js";import{O as Fe,F as Le}from"./FilterOrdersSheet-e5f62342.js";import{f as S}from"./Date-1419e6d2.js";import{N as Me}from"./NoResults-eb849132.js";import"./KolaYellowButton-490da95d.js";import"./disappointed-59090e3a.js";import"./Order-423a7fc9.js";import"./Product-5dbe9562.js";import"./Number-6d4d03a9.js";import"./index-bde9bf13.js";import"./index-ee3c01c5.js";const Pe=D({props:{orders:{type:Array,required:!0}},components:{IonAvatar:W,IonBadge:B,IonIcon:$,IonItem:X,IonLabel:F,IonList:Y,IonPopover:Z,IonContent:L,IonSkeletonText:x,IonButton:M,IonChip:ee,IonText:te,Image:$e,OrderListItem:Fe},computed:{...P(H)},data(){return{sync:oe,create:ne,trash:se,chatbubble:ae,chatbubbleOutline:re,createOutline:ie,ellipsisHorizontal:N,trashOutline:le,event:null,openPopover:-1,selectedOrder:null,showConfirmDeleteModal:!1,filters:A}},methods:{openMenu(e,s){this.event=e,this.openPopover=s},closeMenu(){this.openPopover=-1,this.event=null},deleteSale(e){this.selectedOrder=e,this.showConfirmDeleteModal=!0,this.closeMenu()},async onConfirmDelete(){var e;this.showConfirmDeleteModal=!1,await this.orderStore.deleteOrder((e=this.selectedOrder)==null?void 0:e.id)},viewDetails(e){this.$emit("view-details",e),this.$router.push("/shopper/orders/".concat(e.id))}}});function Ne(e,s,h,b,E,R){const l=n("ion-icon"),r=n("ion-item"),p=n("IonList"),f=n("IonContent"),I=n("IonPopover"),g=n("OrderListItem");return u(),m(p,{lines:"full"},{default:o(()=>[(u(!0),de(ue,null,ce(e.orders,(d,_)=>(u(),m(g,{key:d.id,order:d,onClick:i=>e.viewDetails(d),onOpenMenu:i=>e.openMenu(i,_)},{popover:o(()=>[t(I,{event:e.event,isOpen:e.openPopover==_,onDidDismiss:s[0]||(s[0]=i=>e.openPopover=-1)},{default:o(()=>[t(f,{class:"ion-no-padding"},{default:o(()=>[t(p,{lines:"full",class:"ion-no-padding"},{default:o(()=>[t(r,{button:!0,lines:"full","aria-label":"sync"},{default:o(()=>[t(l,{slot:"start",icon:e.sync,"aria-hidden":"true"},null,8,["icon"]),a(" Re-order ")]),_:1}),t(r,{button:!0,lines:"full"},{default:o(()=>[t(l,{slot:"start",icon:e.chatbubbleOutline},null,8,["icon"]),a(" Message Supplier ")]),_:1}),t(r,{button:!0,lines:"full"},{default:o(()=>[t(l,{slot:"start",icon:e.createOutline},null,8,["icon"]),a(" Edit Order ")]),_:1}),t(r,{button:!0,lines:"full"},{default:o(()=>[t(l,{slot:"start",icon:e.trashOutline},null,8,["icon"]),a(" Delete ")]),_:1})]),_:1})]),_:1})]),_:2},1032,["event","isOpen"])]),_:2},1032,["order","onClick","onOpenMenu"]))),128))]),_:1})}const Te=T(Pe,[["render",Ne],["__scopeId","data-v-310f2d5a"]]),He=D({data(){return{search:pe,arrowBack:_e,ellipsisHorizontal:N,filter:me,optionsOutline:he,add:fe,fetching:!1,filters:A,showFilterSheet:!1,searchFilters:{start_dt:"",end_dt:""}}},components:{IonPage:Ie,IonHeader:ge,IonToolbar:Oe,IonContent:L,IonSegmentButton:ve,IonSegment:Se,IonLabel:F,IonButtons:be,IonBackButton:we,IonBadge:B,IonTitle:ke,PlacedOrderList:Te,NotificationButton:Be,IonButton:M,IonIcon:$,FilterOrdersSheet:Le,NoResults:Me,IonSpinner:ye},computed:{...P(H)},methods:{async fetchOrders(){try{this.fetching=!0,await this.orderStore.fetchPlacedOrders(this.searchFilters)}catch(e){Ce(e)}finally{this.fetching=!1}},onSegmentChanged(e){let s=new Date,h=new Date;switch(e.detail.value){case"pastmonth":s.setMonth(s.getMonth()-1);break;case"today":s.setDate(s.getDate()-1);break;case"thisweek":s.setDate(s.getDate()-7);break}this.searchFilters.start_dt=S(s.toISOString()),this.searchFilters.end_dt=S(h.toISOString()),this.fetchOrders()},onFilterUpdate(e){this.searchFilters.start_dt=e.start_dt,this.searchFilters.end_dt=e.end_dt||S(new Date().toISOString()),this.fetchOrders()}},mounted(){this.onSegmentChanged(new CustomEvent("load",{detail:{value:"thisweek"}}))}});const Ae={class:"ion-padding ion-text-center"};function Ee(e,s,h,b,E,R){const l=n("ion-back-button"),r=n("ion-buttons"),p=n("IonTitle"),f=n("IonIcon"),I=n("IonButton"),g=n("NotificationButton"),d=n("ion-toolbar"),_=n("ion-header"),i=n("IonLabel"),O=n("IonSegmentButton"),V=n("IonSegment"),q=n("IonToolbar"),z=n("IonHeader"),U=n("IonSpinner"),G=n("NoResults"),Q=n("PlacedOrderList"),j=n("FilterOrdersSheet"),J=n("ion-content"),K=n("ion-page");return u(),m(K,null,{default:o(()=>[t(z,{class:"ion-padding ion-no-border"},{default:o(()=>[t(_,{class:"inner-header"},{default:o(()=>[t(d,{class:"ion-align-items-center"},{default:o(()=>[t(r,{slot:"start"},{default:o(()=>[t(l,{defaultHref:"/shopper/home"})]),_:1}),t(p,{size:"small",class:"fw-bold"},{default:o(()=>[a("Order History")]),_:1}),t(r,{slot:"end"},{default:o(()=>[t(I,{onClick:s[0]||(s[0]=c=>e.showFilterSheet=!0),color:"dark"},{default:o(()=>[t(f,{icon:e.optionsOutline},null,8,["icon"])]),_:1}),t(g)]),_:1})]),_:1})]),_:1}),t(q,null,{default:o(()=>[t(V,{value:"thisweek",mode:"ios",onIonChange:s[1]||(s[1]=c=>e.onSegmentChanged(c))},{default:o(()=>[t(O,{value:"today"},{default:o(()=>[t(i,null,{default:o(()=>[a(v(e.$t("general.today")),1)]),_:1})]),_:1}),t(O,{value:"thisweek"},{default:o(()=>[t(i,null,{default:o(()=>[a(v(e.$t("general.thisWeek")),1)]),_:1})]),_:1}),t(O,{value:"pastmonth"},{default:o(()=>[t(i,null,{default:o(()=>[a(v(e.$t("general.pastMonth")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(J,null,{default:o(()=>{var c;return[k(C("div",Ae,[t(U,{name:"crescent"})],512),[[y,e.fetching]]),k(C("section",null,[((c=e.orderStore.orders)==null?void 0:c.length)==0?(u(),m(G,{key:0})):De("",!0),t(Q,{orders:e.orderStore.orders},null,8,["orders"])],512),[[y,!e.fetching]]),t(j,{isOpen:e.showFilterSheet,onDidDismiss:s[2]||(s[2]=w=>e.showFilterSheet=!1),onUpdate:s[3]||(s[3]=w=>e.onFilterUpdate(w))},null,8,["isOpen"])]}),_:1})]),_:1})}const et=T(He,[["render",Ee],["__scopeId","data-v-b9685494"]]);export{et as default};
