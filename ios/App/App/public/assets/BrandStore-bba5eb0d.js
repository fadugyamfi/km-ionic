var v=Object.defineProperty;var l=(t,s,a)=>s in t?v(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var r=(t,s,a)=>(l(t,typeof s!="symbol"?s+"":s,a),a);import{a4 as b,a5 as f,a6 as o,C as n,v as d}from"./index-f92ce253.js";import{P as m}from"./Product-5dbe9562.js";class i{constructor(s){r(this,"id");r(this,"name");r(this,"description");r(this,"created_at");r(this,"updated_at");r(this,"logo");r(this,"favorited");Object.assign(this,s)}addToFavorites(s){this.favorited=s||{brands_id:this.id}}unfavorite(){this.favorited=null}getInitials(s=3){var a;return(a=this.name)==null?void 0:a.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,s)}}const c=new b,h="kola.brands",F=f("brand",{state:()=>({brands:[],selectedBrand:null,brandProducts:[]}),actions:{async persist(){c.set(h,this.brands)},async loadFromStorage(){const t=await c.get(h);return t&&(this.brands=t.map(s=>new i(s))),this.brands},async fetchBrands(){return await this.loadFromStorage(),this.brands.length>0?this.brands:o.get("/v2/brands").then(t=>{this.brands=t.data.data.map(s=>new i(s)),this.persist()}).catch(t=>{console.log(t)})},async getBrands(){return this.brands.length==0&&await this.fetchBrands(),this.brands},async getBrand(t){return(await this.getBrands()).find(a=>a.id==t)},setSelectedBrand(t){this.selectedBrand=t},async fetchBrandProducts(t,s=1,a=50){try{const e={brands_id:t.id,limit:a,page:s,sort:"latest"},u=await o.get("/v2/products",{params:e});return this.brandProducts=u.data.data.map(p=>new m(p)),this.brandProducts}catch(e){return n(e),[]}},async addToFavorites(t){const s=d();t.addToFavorites();try{const e=(await o.post("/v2/brands/".concat(t.id,"/favorites"))).data.data;t.addToFavorites({brands_id:t.id,cms_users_id:e.cms_users_id}),s.showSuccess("Added To Favorites"),this.persist()}catch(a){n(a),t.unfavorite()}},async removeFromFavorites(t){const s=d();t.unfavorite();try{const a=await o.delete("/v2/brands/".concat(t.id,"/favorites"));s.showError("Removed From Favorites"),this.persist()}catch(a){n(a),t.addToFavorites()}}}});export{i as B,F as u};
