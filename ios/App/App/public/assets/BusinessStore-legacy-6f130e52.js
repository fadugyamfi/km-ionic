System.register(["./index-legacy-cc225d81.js","./Product-legacy-3e97f985.js"],(function(s,e){"use strict";var t,a,i,n,r,u,o,c,d;return{setters:[s=>{t=s.a4,a=s.v,i=s.a5,n=s.a6,r=s.am,u=s.C,o=s.aY,c=s.a},s=>{d=s.P}],execute:function(){const e=new t;a(),s("u",i("business",{state:()=>({businesses:null,customers:null,selectedBusiness:null,selectedToView:null,registration:{name:"",phone_number:"",location:"",business_types_id:1,business_owner_name:"",business_owner_phone:"",email:"",value:"",gps:"",country_id:83,region_id:54,city:"",currency_id:1,logo_image:"",tax_number:"",min_order_amount:0,socials:{facebook:"",twitter:"",instagram:"",website:""},attributes:{year_established:"",primary_product_category_id:"",number_of_products:"",number_of_unique_products:"",number_of_small_retailers:"",catalog_update_frequency:"",number_of_stores:"",business_is_in_large_retail_chain:"No",how_you_heard_about_kola:"",goals_and_expectation_of_kolamarket:""},user:{pin:"",pin_confirmation:""}},searchQuery:"",SearchResults:[]}),actions:{async loadCachedBusinesses(){this.businesses||(this.businesses=await e.get("kola.businesses")||[]),this.selectedBusiness||(this.selectedBusiness=await e.get("kola.store.business"))},getCacheBusinessData:async()=>await e.get("businessInfo"),async cacheBusinessData(s){let t=this.getCacheBusinessData();if(null!==t)return Object.assign(t,s),void(await e.set("businessInfo",t));await e.set("businessInfo",s)},async getSuppliers(s="",e={}){const t={approved_vendor:1,...e};return this.getBusinesses(s,t)},async getBusinesses(s="",e={},t=!1){try{const a=await n.get("/v2/businesses",{params:{name_like:s,...e}});if(a){const{data:s,links:e}=a.data,i=s.map((s=>new r(s)));return this.businesses=t?[...this.businesses||[],...i]:i,this.businesses}return[]}catch(a){return u(a),[]}},async getBusiness(s){try{const e=await n.get(`/v2/businesses/${s}`);if(e){const{data:s}=e.data;return new r(s)}return null}catch(e){return u(e),null}},async getBusinessProducts(s,e=50){try{const t={businesses_id:s.id,limit:e},a=await n.get("/v2/products",{params:t});if(a){const{data:s}=a.data;return s.map((s=>new d(s)))}return[]}catch(t){return u(t),[]}},async getBusinessCustomers(s,t=50,a={},i=!1){const o=`kola.business.${s.id}.customers`;if(await e.has(o)&&!i)return(await e.get(o)).map((s=>new r(s)));try{const i={limit:t,sort:"name:asc",...a},u=await n.get(`/v2/businesses/${s.id}/customers`,{params:i});if(u){const{data:s}=u.data,t=s.map((s=>new r(s)));return await e.set(o,t,7,"days"),t}}catch(c){u(c)}return[]},async getBusinessSaleAgents(s,t=50,a=!1){const i=`kola.business.${s.id}.sale-agents`;if(await e.has(i)&&!a)return(await e.get(i)).map((s=>new o(s)));try{const a={businesses_id:s.id,limit:t,sort:"name:asc"},r=await n.get("/v2/sale-agents",{params:a});if(r){const{data:s}=r.data,t=s.map((s=>new o(s)));return await e.set(i,t,7,"days"),t}}catch(r){u(r)}return[]},async storeBusinesses(){await e.set("store.businesses",this.businesses)},async setSearchQuery(s){this.searchQuery=s,await this.clearBusinesses()},clearBusinesses(){this.businesses=[]},getSelectedBusiness(){return this.selectedBusiness},hasSelectedBusiness(){return null!=this.selectedBusiness},async clearSelectedBusiness(){this.selectedBusiness=null,await e.remove("kola.store.business")},async setSelectedBusiness(s){this.selectedBusiness=s,await e.set("kola.store.business",s)},selectDefaultBusiness(){this.setSelectedBusiness(null!=this.businesses?this.businesses[0]:null)},async createBusinessAsShopper(s){return n.post("/v2/businesses",s).then((s=>{if(s.status>=200&&s.status<300){const e=c(),t=s.data.data;return this.setSelectedBusiness(t.business),e.setActiveBusiness(t.business),e.storeOnboarded(!0),t.business}})).catch((s=>u(s)))},async createBusinessAsVendor(){return n.post("/v2/businesses",this.registration).then((s=>{if(s.status>=200&&s.status<300){const e=c(),t=s.data.data;return this.setSelectedBusiness(t.business),e.setActiveBusiness(t.business),e.storeOnboarded(!0),t.business}})).catch((s=>u(s)))},async loadCachedRegistrationInfo(){await e.has("kola.business-registration")&&(this.registration=await e.get("kola.business-registration"))},async cacheRegistrationInfo(){await e.set("kola.business-registration",this.registration,3,"days")},async clearCachedRegistrationInfo(){await e.remove("kola.business-registration")},async addToFavorites(s){const e=a();s.addToFavorites();try{const t=(await n.post(`/v2/businesses/${s.id}/favorites`)).data.data;s.addToFavorites({businesses_id:s.id,cms_users_id:t.cms_users_id}),e.showSuccess("Added To Favorites"),this.persist()}catch(t){u(t),s.unfavorite()}},persist(){this.storeBusinesses()},async removeFromFavorites(s){const e=a();s.unfavorite();try{await n.delete(`/v2/businesses/${s.id}/favorites`),e.showError("Removed From Favorites"),this.persist()}catch(t){u(t),s.addToFavorites()}},viewBusiness(s){this.selectedToView=s},getSelectedForViewing(){return this.selectedToView}}}))}}}));
