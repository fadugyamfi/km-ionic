import{d as q,i as z,k as j,p as D,F as G,r as J,j as Q,L as U,G as X,I as M,ax as O,N as W,aT as Z,q as x,ad as ee,bd as ne,n as oe,h as te,Q as se,m as ae,bl as re,bm as le,ae as ie,aI as ce,as as de,aJ as ue,s as me,a as Ie,C as fe,v as he,_ as pe,x as n,o as r,c as i,w as s,f as m,e as o,t as l,B as I,A as S,g as f,X as _e,Y as ge}from"./index-f92ce253.js";import{K as Se}from"./KolaYellowButton-490da95d.js";import{u as be}from"./SaleStore-6ada4812.js";import{I as Ce}from"./Image-ab8c6f04.js";import{u as ke}from"./BusinessStore-3612150a.js";import"./Product-5dbe9562.js";import"./Date-1419e6d2.js";import"./index-bde9bf13.js";import"./index-ee3c01c5.js";const Be=q({components:{IonPage:z,IonHeader:j,IonToolbar:D,IonButtons:G,IonButton:J,IonBackButton:Q,IonIcon:U,IonTitle:X,IonContent:M,IonList:O,IonItem:W,IonListHeader:Z,IonLabel:x,IonAvatar:ee,IonCheckbox:ne,IonText:oe,IonFooter:te,KolaYellowButton:Se,IonImg:se,Image:Ce,IonSpinner:ae,IonRefresher:re,IonRefresherContent:le,IonSearchbar:ie},data(){return{search:ce,close:de,arrowBack:ue,fetching:!1,refreshing:!1,searchEnabled:!1,agents:[],filteredAgents:[]}},computed:{...me(Ie,be,ke)},methods:{async handleRefresh(e){this.refreshing=!0,await this.fetchSaleAgents(),this.refreshing=!1,e.target.complete()},async fetchSaleAgents(){this.fetching=!0;try{this.agents=await this.businessStore.getBusinessSaleAgents(this.userStore.activeBusiness,200,this.refreshing),this.filteredAgents=this.agents}catch(e){fe(e)}finally{this.fetching=!1}},selectAgent(e){this.saleStore.newSale.cms_users_id=e.id},onContinue(){if(!this.saleStore.newSale.cms_users_id){he().showError(this.$t("vendor.sales.selectAgentToContinue"),"","bottom","agent-continue");return}this.$router.push("/vendor/sales/add-sale/select-sale-type")},onSearch(e){var c;const a=(c=e.target)==null?void 0:c.value;this.filteredAgents=this.agents.filter(h=>{var d;return(d=h.name)==null?void 0:d.toLowerCase().includes(a.toLowerCase())})}},mounted(){this.fetchSaleAgents()}}),ve={class:"ion-padding"},Ae={key:0,class:"ion-text-center ion-padding"},we={class:"ion-no-margin"};function $e(e,a,c,h,d,Le){const b=n("IonBackButton"),p=n("IonButtons"),C=n("IonTitle"),k=n("IonIcon"),B=n("ion-button"),_=n("IonToolbar"),v=n("IonSearchbar"),A=n("IonHeader"),w=n("IonRefresherContent"),$=n("IonRefresher"),L=n("IonSpinner"),g=n("IonLabel"),T=n("IonListHeader"),y=n("Image"),R=n("IonAvatar"),E=n("IonText"),H=n("IonCheckbox"),F=n("IonItem"),K=n("IonList"),N=n("IonContent"),V=n("KolaYellowButton"),Y=n("IonFooter"),P=n("IonPage");return r(),i(P,null,{default:s(()=>[m("section",ve,[o(A,{class:"ion-no-border",style:{"box-shadow":"none"}},{default:s(()=>[o(_,{class:"inner-header"},{default:s(()=>[o(p,{slot:"start"},{default:s(()=>[o(b,{defaultHref:"/vendor/sales",icon:e.arrowBack,mode:"md"},null,8,["icon"])]),_:1}),o(C,{size:"small"},{default:s(()=>[m("b",null,l(e.$t("vendor.sales.addSale")),1)]),_:1}),o(p,{slot:"end"},{default:s(()=>[o(B,{onClick:a[0]||(a[0]=t=>e.searchEnabled=!e.searchEnabled),color:"dark"},{default:s(()=>[o(k,{icon:e.search},null,8,["icon"])]),_:1})]),_:1})]),_:1}),e.searchEnabled?(r(),i(_,{key:0},{default:s(()=>[o(v,{placeholder:e.$t("vendor.sales.filterAgents")+"...",class:"search-input",onKeyup:a[1]||(a[1]=t=>e.onSearch(t)),onIonChange:a[2]||(a[2]=t=>e.onSearch(t)),onIonClear:a[3]||(a[3]=t=>e.onSearch(t)),onIonCancel:a[4]||(a[4]=t=>e.onSearch(t))},null,8,["placeholder"])]),_:1})):I("",!0)]),_:1})]),o(N,null,{default:s(()=>[o($,{ref:"refresher",slot:"fixed",onIonRefresh:a[5]||(a[5]=t=>e.handleRefresh(t))},{default:s(()=>[o(w,{pullingIcon:"crescent"})]),_:1},512),e.fetching?(r(),S("div",Ae,[o(L,{name:"crescent"})])):I("",!0),e.fetching?I("",!0):(r(),i(K,{key:1,lines:"none",class:"ion-padding-horizontal sales-select-list simple"},{default:s(()=>[o(T,null,{default:s(()=>[o(g,{class:"fw-bold"},{default:s(()=>[f(l(e.$t("vendor.sales.selectSaleAgent")),1)]),_:1})]),_:1}),(r(!0),S(ge,null,_e(e.filteredAgents,t=>(r(),i(F,{key:t.id,onClick:u=>e.selectAgent(t)},{default:s(()=>[o(R,{slot:"start"},{default:s(()=>[o(y,{src:t.image},null,8,["src"])]),_:2},1024),o(g,null,{default:s(()=>[m("p",we,l(t.name),1),o(E,{color:"medium",class:"font-medium"},{default:s(()=>{var u;return[f(l(((u=t.role)==null?void 0:u.name)||e.$t("vendor.sales.saleAgent")),1)]}),_:2},1024)]),_:2},1024),o(H,{"aria-label":t.name,slot:"end",mode:"ios",value:t.id,checked:e.saleStore.newSale.cms_users_id==t.id},null,8,["aria-label","value","checked"])]),_:2},1032,["onClick"]))),128))]),_:1}))]),_:1}),o(Y,{class:"ion-padding ion-no-border"},{default:s(()=>[o(V,{id:"agent-continue",disabled:!e.saleStore.newSale.cms_users_id,onClick:a[6]||(a[6]=t=>e.onContinue())},{default:s(()=>[f(l(e.$t("general.continue")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})}const Ye=pe(Be,[["render",$e]]);export{Ye as default};
