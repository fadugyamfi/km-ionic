import{d as b,b0 as ae,bf as P,L as H,ad as K,n as N,_ as y,x as n,o as S,c as g,w as t,f as r,e as o,t as d,g as i,I as R,r as U,ax as Y,N as G,q as V,ap as W,az as le,aG as j,s as E,A as ie,X as re,Y as de,B as Q,W as ue,h as pe,a9 as q,aa as J,ab as X,l as ce,R as me,S as _e,i as fe,k as Ie,p as he,F as Se,j as ve,G as ge,m as $e,aO as we,aN as Ce,bn as ke,bo as be,aI as ye,aJ as Be,aK as De,aL as Fe,aM as Me,aP as z,aQ as A}from"./index-f92ce253.js";import{S as Oe}from"./ShopperHeader-3bb3d36f.js";import{u as Z}from"./SaleStore-6ada4812.js";import{f as x}from"./Filters-875bda85.js";import{I as ee}from"./Image-ab8c6f04.js";import{f as T}from"./Date-1419e6d2.js";import{N as Le}from"./NoResults-eb849132.js";import{K as oe}from"./KolaYellowButton-490da95d.js";import{K as Te}from"./KolaWhiteButton-71dee6cb.js";import"./NotificationButton-bfbf6cba.js";import"./disappointed-59090e3a.js";import"./ProductStore-cdc6633e.js";import"./Product-5dbe9562.js";import"./Number-6d4d03a9.js";import"./index-bde9bf13.js";import"./index-ee3c01c5.js";const Pe=b({props:{isOpen:{default:!1},sale:{default:null,type:Object}},emits:["dismiss","confirm"],data(){return{warningOutline:ae}},components:{IonModal:P,IonIcon:H,IonAvatar:K,IonText:N,KolaYellowButton:oe,KolaWhiteButton:Te},methods:{close(){this.$el.dismiss()},confirm(){this.$emit("confirm"),this.close()},dismiss(){this.$emit("dismiss"),this.close()}}});const He={class:"wrapper ion-padding"},Ke={class:"ion-text-center"},Ne={class:"d-flex ion-justify-content-center"},Re={class:"fw-semibold"};function Ve(e,s,$,C,B,D){const f=n("IonIcon"),c=n("IonAvatar"),p=n("IonText"),I=n("KolaYellowButton"),m=n("KolaWhiteButton"),v=n("IonModal");return S(),g(v,{isOpen:e.isOpen,id:"delete-sale-modal",ref:"modal"},{default:t(()=>[r("div",He,[r("div",Ke,[r("p",Ne,[o(c,null,{default:t(()=>[o(f,{icon:e.warningOutline,color:"danger"},null,8,["icon"])]),_:1})]),r("p",Re,d(e.$t("vendor.sales.confirmDeleteSale")),1),r("p",null,[o(p,{color:"muted"},{default:t(()=>[i(d(e.$t("vendor.sales.actionIsUnreversible")),1)]),_:1})])]),o(I,{class:"ion-margin-top",onClick:s[0]||(s[0]=h=>e.confirm())},{default:t(()=>[i(d(e.$t("general.delete")),1)]),_:1}),o(m,{style:{"margin-top":"8px"},onClick:s[1]||(s[1]=h=>e.dismiss())},{default:t(()=>[i(d(e.$t("general.cancel")),1)]),_:1})])]),_:1},8,["isOpen"])}const ze=y(Pe,[["render",Ve],["__scopeId","data-v-c049aa0a"]]),Ae=b({props:{sales:{default:[],type:Array}},components:{IonContent:R,IonButton:U,IonIcon:H,IonList:Y,IonItem:G,IonAvatar:K,IonLabel:V,IonText:N,IonChip:W,Image:ee,IonPopover:le,IonModal:P,DeleteSaleModal:ze},data(){return{ellipsisHorizontal:j,filters:x,openPopover:-1,event:null,selectedSale:null,showConfirmDeleteModal:!1}},computed:{...E(Z)},methods:{openMenu(e,s=-1){this.event=e,this.openPopover=s},closeMenu(){this.openPopover=-1,this.event=null},recordRepayment(e){this.closeMenu(),this.$router.push("/vendor/sales/record-repayment")},deleteSale(e){this.selectedSale=e,this.showConfirmDeleteModal=!0,this.closeMenu()},async onConfirmDelete(){this.showConfirmDeleteModal=!1,await this.saleStore.deleteSale(this.selectedSale)},viewDetails(e){this.$router.push("/vendor/sales/".concat(e.id))}}}),Ue={class:"font-medium"},Ye=r("span",{class:"ion-margin-horizontal"},"|",-1);function Ge(e,s,$,C,B,D){const f=n("Image"),c=n("IonAvatar"),p=n("IonText"),I=n("IonChip"),m=n("IonLabel"),v=n("IonIcon"),h=n("IonButton"),_=n("IonItem"),u=n("IonList"),F=n("IonContent"),M=n("IonPopover"),O=n("DeleteSaleModal");return S(),g(u,{lines:"full"},{default:t(()=>[(S(!0),ie(de,null,re(e.sales,(l,k)=>(S(),g(_,{key:l.id,onClick:a=>e.viewDetails(l)},{default:t(()=>[o(c,{slot:"start",class:"ion-align-self-start"},{default:t(()=>{var a;return[o(f,{src:(a=l.customer)==null?void 0:a.logo},null,8,["src"])]}),_:2},1024),o(m,null,{default:t(()=>[r("p",null,[o(p,{color:"dark"},{default:t(()=>{var a;return[i(d((a=l.customer)==null?void 0:a.name),1)]}),_:2},1024)]),r("p",Ue,[o(p,{color:"medium"},{default:t(()=>[i(d(e.filters.date(l.created_at,"short")),1)]),_:2},1024),Ye,o(p,{color:"medium"},{default:t(()=>[i(d(e.$tc("general.products",l.sale_items_count,{count:l.sale_items_count})),1)]),_:2},1024)]),r("p",null,[l.isCreditSale()?(S(),g(I,{key:0,color:"primary",class:"font-medium"},{default:t(()=>{var a;return[i(d((a=l.sale_type)==null?void 0:a.name),1)]}),_:2},1024)):Q("",!0)])]),_:2},1024),o(h,{slot:"end",fill:"clear",color:"dark",class:"ion-align-self-start ion-margin-top",onClick:ue(a=>e.openMenu(a,k),["stop"])},{default:t(()=>[o(v,{icon:e.ellipsisHorizontal},null,8,["icon"])]),_:2},1032,["onClick"]),o(M,{event:e.event,isOpen:e.openPopover==k,onDidDismiss:s[0]||(s[0]=a=>e.openPopover=-1)},{default:t(()=>[o(F,{class:"ion-no-padding"},{default:t(()=>[o(u,{lines:"full",class:"ion-no-padding"},{default:t(()=>[o(_,{button:!0,onClick:a=>e.recordRepayment(l)},{default:t(()=>[o(m,null,{default:t(()=>[i(d(e.$t("vendor.sales.recordRepayment")),1)]),_:1})]),_:2},1032,["onClick"]),o(_,{button:!0,onClick:a=>e.deleteSale(l)},{default:t(()=>[o(m,null,{default:t(()=>[i(d(e.$t("general.delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["event","isOpen"])]),_:2},1032,["onClick"]))),128)),o(O,{isOpen:e.showConfirmDeleteModal,sale:e.selectedSale,onDismiss:s[1]||(s[1]=l=>e.showConfirmDeleteModal=!1),onConfirm:s[2]||(s[2]=l=>e.onConfirmDelete())},null,8,["isOpen","sale"])]),_:1})}const We=y(Ae,[["render",Ge]]),je=b({components:{IonModal:P,IonContent:R,IonFooter:pe,KolaYellowButton:oe,IonGrid:q,IonRow:J,IonCol:X,IonLabel:V,IonInput:ce},data(){return{form:{start_dt:"",end_dt:""}}},emits:["update"],methods:{update(){this.$el.dismiss(),this.$emit("update",this.form)}}});const Ee=e=>(me("data-v-6639fd85"),e=e(),_e(),e),Qe=Ee(()=>r("header",{class:"fw-semibold ion-padding ion-text-center"}," Filter Sales History ",-1)),qe={class:"ion-padding-vertical"},Je={class:"ion-padding"};function Xe(e,s,$,C,B,D){const f=n("IonLabel"),c=n("IonInput"),p=n("IonCol"),I=n("IonRow"),m=n("IonGrid"),v=n("KolaYellowButton"),h=n("IonContent"),_=n("IonModal");return S(),g(_,{ref:"modal","initial-breakpoint":.5,breakpoints:[0,.5]},{default:t(()=>[o(h,null,{default:t(()=>[Qe,r("main",qe,[o(m,null,{default:t(()=>[o(I,null,{default:t(()=>[o(p,{size:"6"},{default:t(()=>[o(f,null,{default:t(()=>[i("Date From")]),_:1}),o(c,{class:"kola-input",type:"date",modelValue:e.form.start_dt,"onUpdate:modelValue":s[0]||(s[0]=u=>e.form.start_dt=u)},null,8,["modelValue"])]),_:1}),o(p,{size:"6"},{default:t(()=>[o(f,null,{default:t(()=>[i("Date To")]),_:1}),o(c,{class:"kola-input",type:"date",modelValue:e.form.end_dt,"onUpdate:modelValue":s[1]||(s[1]=u=>e.form.end_dt=u)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),r("footer",Je,[o(v,{onClick:s[2]||(s[2]=u=>e.update())},{default:t(()=>[i(" Update ")]),_:1})])]),_:1})]),_:1},512)}const Ze=y(je,[["render",Xe],["__scopeId","data-v-6639fd85"]]),xe=b({components:{IonPage:fe,IonContent:R,IonGrid:q,IonRow:J,IonCol:X,IonButton:U,ShopperHeader:Oe,IonHeader:Ie,IonToolbar:he,IonButtons:Se,IonBackButton:ve,IonTitle:ge,IonIcon:H,IonList:Y,IonItem:G,IonSpinner:$e,IonAvatar:K,IonLabel:V,IonText:N,IonChip:W,IonSegment:we,IonSegmentButton:Ce,Image:ee,IonFab:ke,IonFabButton:be,NoResults:Le,SalesList:We,FilterSalesSheet:Ze},data(){return{search:ye,arrowBack:Be,ellipsisHorizontal:j,filter:De,optionsOutline:Fe,add:Me,fetching:!1,filters:x,showFilterSheet:!1,searchFilters:{start_dt:"",end_dt:""}}},computed:{...E(Z)},methods:{onAddSale(){this.saleStore.resetForNewSale(),this.$router.push("/vendor/sales/add-sale/select-agent")},async fetchSales(){try{this.fetching=!0,await this.saleStore.fetchSales(this.searchFilters)}catch(e){console.log(e)}finally{this.fetching=!1}},onSegmentChanged(e){let s=new Date,$=new Date;switch(e.detail.value){case"pastmonth":s.setMonth(s.getMonth()-1);break;case"today":s.setDate(s.getDate()-1);break;case"thisweek":s.setDate(s.getDate()-7);break}this.searchFilters.start_dt=T(s.toISOString()),this.searchFilters.end_dt=T($.toISOString()),this.fetchSales()},onFilterUpdate(e){this.searchFilters.start_dt=e.start_dt,this.searchFilters.end_dt=e.end_dt||T(new Date().toISOString()),this.fetchSales()}},mounted(){this.onSegmentChanged(new CustomEvent("load",{detail:{value:"thisweek"}}))}});const eo={class:"ion-padding ion-text-center"};function oo(e,s,$,C,B,D){const f=n("IonBackButton"),c=n("IonButtons"),p=n("IonTitle"),I=n("IonIcon"),m=n("IonButton"),v=n("IonToolbar"),h=n("IonHeader"),_=n("IonLabel"),u=n("IonSegmentButton"),F=n("IonSegment"),M=n("IonFabButton"),O=n("IonFab"),l=n("IonSpinner"),k=n("NoResults"),a=n("SalesList"),te=n("FilterSalesSheet"),ne=n("ion-content"),se=n("IonPage");return S(),g(se,null,{default:t(()=>[o(h,{class:"ion-padding ion-no-border"},{default:t(()=>[o(h,{class:"inner-header ion-margin-bottom"},{default:t(()=>[o(v,null,{default:t(()=>[o(c,{slot:"start"},{default:t(()=>[o(f,{defaultHref:"/vendor/home",icon:e.arrowBack,mode:"md"},null,8,["icon"])]),_:1}),o(p,{size:"small"},{default:t(()=>[r("b",null,d(e.$t("vendor.sales.salesHistory")),1)]),_:1}),o(c,{slot:"end"},{default:t(()=>[o(m,{onClick:s[0]||(s[0]=w=>e.showFilterSheet=!0),color:"dark"},{default:t(()=>[o(I,{icon:e.optionsOutline},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),o(F,{value:"thisweek",mode:"ios",onIonChange:s[1]||(s[1]=w=>e.onSegmentChanged(w))},{default:t(()=>[o(u,{value:"today"},{default:t(()=>[o(_,null,{default:t(()=>[i(d(e.$t("general.today")),1)]),_:1})]),_:1}),o(u,{value:"thisweek"},{default:t(()=>[o(_,null,{default:t(()=>[i(d(e.$t("general.thisWeek")),1)]),_:1})]),_:1}),o(u,{value:"pastmonth"},{default:t(()=>[o(_,null,{default:t(()=>[i(d(e.$t("general.pastMonth")),1)]),_:1})]),_:1})]),_:1})]),_:1}),o(ne,null,{default:t(()=>{var w;return[o(O,{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:t(()=>[o(M,{size:"small",onClick:s[2]||(s[2]=L=>e.onAddSale())},{default:t(()=>[o(I,{icon:e.add},null,8,["icon"])]),_:1})]),_:1}),z(r("div",eo,[o(l,{name:"crescent"})],512),[[A,e.fetching]]),z(r("section",null,[((w=e.saleStore.sales)==null?void 0:w.length)==0?(S(),g(k,{key:0})):Q("",!0),o(a,{sales:e.saleStore.sales},null,8,["sales"])],512),[[A,!e.fetching]]),o(te,{isOpen:e.showFilterSheet,onDidDismiss:s[3]||(s[3]=L=>e.showFilterSheet=!1),onUpdate:s[4]||(s[4]=L=>e.onFilterUpdate(L))},null,8,["isOpen"])]}),_:1})]),_:1})}const vo=y(xe,[["render",oo],["__scopeId","data-v-9e4c4b36"]]);export{vo as default};
