import{a5 as B,a as U,a6 as P,C as N,d as q,v as _,aj as A,u as O,z as k,o as T,c as L,w as n,e as a,b as e,k as C,p as M,F as z,j as F,bp as H,G as x,g as u,t as m,f as b,l as f,K as d,r as D,L as E,M as K,U as h,bq as V,V as p,h as R,W as S,I as j,i as G,_ as W}from"./index-f92ce253.js";import{K as Y}from"./KolaYellowButton-490da95d.js";import{u as J}from"./useGeolocation-a393827f.js";import{u as Q}from"./form-59f00665.js";import"./index-ee3c01c5.js";const X=B("customer",{state:()=>({customers:[]}),actions:{async createBusinessCustomer(g){var c;const i=U();return P.post("/v2/businesses/".concat((c=i.activeBusiness)==null?void 0:c.id,"/customers"),g).then(r=>{if(r.status>=200&&r.status<300)return r.data.data}).catch(r=>N(r))}}}),Z=q({__name:"AddCustomer",setup(g){const i=_(),c=X(),r=A(),I=O(),t=Q({name:"",location:"",business_name:"",phone_number:"",cms_users_id:1,payment_method:""}),v=k(()=>r.fullPath.includes("vendor")?"/vendor/profile":"/shopper/profile"),$=k(()=>{const l=t.fields;return l.name.length>0&&l.business_name.length>0&&l.location.length>0&&isNaN(Number(l.cms_users_id))==!1&&l.phone_number.length>0&&l.payment_method}),y=async()=>{try{i.blockUI("Hold On As We Add Your Customer"),await c.createBusinessCustomer({...t.fields,business_types_id:1})?(i.unblockUI(),I.push("".concat(v.value,"/company/customers")),i.showSuccess("Customer has been added successfully")):(i.unblockUI(),i.showError("Failed to add Customer. Please try again","","bottom","footer"))}catch(l){}finally{i.unblockUI()}},w=async()=>{const l=_(),{getCurrentLocation:o}=J();try{const s=await o();s&&(t.fields.location="".concat(s.coords.latitude,", ").concat(s.coords.longitude))}catch(s){l.showError("Cannot retrieve location info")}};return(l,o)=>(T(),L(e(G),null,{default:n(()=>[a(e(C),{class:"ion-padding ion-no-border"},{default:n(()=>[a(e(C),{class:"inner-header ion-no-border"},{default:n(()=>[a(e(M),{class:"ion-align-items-center"},{default:n(()=>[a(e(z),{slot:"start"},{default:n(()=>[a(e(F),{color:"dark",icon:e(H),text:"",style:{"margin-left":"10px"},defaultHref:"".concat(v.value,"/company/customers")},null,8,["icon","defaultHref"])]),_:1}),a(e(x),{size:"small",class:"fw-bold"},{default:n(()=>[u(m(l.$t("profile.customers.addCustomer")),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(e(j),{class:"ion-padding"},{default:n(()=>[b("form",{onSubmit:o[13]||(o[13]=S(s=>y(),["prevent"]))},[a(e(f),{class:d(["kola-input ion-margin-bottom",{"ion-invalid ion-touched":e(t).errors.name}]),label:l.$t("profile.customers.fullName"),labelPlacement:"stacked",fill:"solid",modelValue:e(t).fields.name,"onUpdate:modelValue":o[0]||(o[0]=s=>e(t).fields.name=s),name:"name",onIonInput:o[1]||(o[1]=s=>e(t).validate(s)),required:""},null,8,["class","label","modelValue"]),a(e(f),{class:d(["kola-input ion-margin-bottom",{"ion-invalid ion-touched":e(t).errors.business_name}]),label:l.$t("profile.customers.businessName"),labelPlacement:"stacked",fill:"solid",modelValue:e(t).fields.business_name,"onUpdate:modelValue":o[2]||(o[2]=s=>e(t).fields.business_name=s),name:"business_name",onIonInput:o[3]||(o[3]=s=>e(t).validate(s)),required:""},null,8,["class","label","modelValue"]),a(e(f),{class:d(["kola-input",{"ion-invalid ion-touched":e(t).errors.location}]),label:l.$t("profile.customers.businessLocation"),labelPlacement:"stacked",fill:"solid",modelValue:e(t).fields.location,"onUpdate:modelValue":o[4]||(o[4]=s=>e(t).fields.location=s),name:"business_location",onIonInput:o[5]||(o[5]=s=>e(t).validate(s)),required:""},null,8,["class","label","modelValue"]),a(e(D),{fill:"clear",size:"small",style:{"text-transform":"none"},class:"ion-margin-bottom use-location ion-text-start",onClick:o[6]||(o[6]=s=>w())},{default:n(()=>[a(e(E),{icon:e(K),style:{"margin-right":"5px"}},null,8,["icon"]),u(" "+m(l.$t("profile.customers.location.useCurrentLocation")),1)]),_:1}),a(e(f),{class:d(["kola-input ion-margin-bottom",{"ion-invalid ion-touched":e(t).errors.phone_number}]),label:"Phone Number",labelPlacement:"stacked",fill:"solid",modelValue:e(t).fields.phone_number,"onUpdate:modelValue":o[7]||(o[7]=s=>e(t).fields.phone_number=s),name:"phone",onIonInput:o[8]||(o[8]=s=>e(t).validate(s)),required:""},null,8,["class","modelValue"]),b("h6",null,m(l.$t("profile.customers.assignToSalesAgentOrManager")),1),a(e(h),{class:d(["kola-input ion-margin-bottom",{"ion-invalid ion-touched":e(t).errors.cms_users_id}]),label:l.$t("profile.customers.selectSaleAgent"),labelPlacement:"stacked",fill:"solid",modelValue:e(t).fields.cms_users_id,"onUpdate:modelValue":o[9]||(o[9]=s=>e(t).fields.cms_users_id=s),required:"",name:"sales-agent","toggle-icon":e(V),onIonChange:o[10]||(o[10]=s=>e(t).validateSelectInput(s))},{default:n(()=>[a(e(p))]),_:1},8,["label","class","modelValue","toggle-icon"]),b("h6",null,m(l.$t("profile.customers.howDoTheyUsuallyPay")),1),a(e(h),{class:d(["kola-input ion-margin-bottom",{"ion-invalid ion-touched":e(t).errors.payment_method}]),label:l.$t("profile.customers.selectPaymentMethod"),labelPlacement:"stacked","toggle-icon":e(V),fill:"solid",modelValue:e(t).fields.payment_method,"onUpdate:modelValue":o[11]||(o[11]=s=>e(t).fields.payment_method=s),required:"",name:"payment-method",onIonChange:o[12]||(o[12]=s=>e(t).validateSelectInput(s))},{default:n(()=>[a(e(p),null,{default:n(()=>[u("Mobile money")]),_:1}),a(e(p),null,{default:n(()=>[u("Cash")]),_:1}),a(e(p),null,{default:n(()=>[u("Bank transfer")]),_:1})]),_:1},8,["label","class","toggle-icon","modelValue"]),a(e(R),{class:"ion-padding-top ion-no-border"},{default:n(()=>[a(Y,{disabled:!$.value,onClick:S(y,["prevent"])},{default:n(()=>[u(m(l.$t("profile.customers.save")),1)]),_:1},8,["disabled","onClick"])]),_:1})],32)]),_:1})]),_:1}))}});const ae=W(Z,[["__scopeId","data-v-240a2fad"]]);export{ae as default};
